**WannaCry (cluster 5) - YARA rules generated by malware genomic analysis**

This folder contains Yara rules automatically generated by MAGIC for WannaCry. 

The rules were generated using a cluster of the following 6 samples.

    15e3f4f2412838cea63213ab0e27d089983cc2fd
    82d3d0dc267b2d85e5a33e3316bfbf7480045420
    426ffd1415e6c78d6376584c83c10b6dd137a16b
    7408c7bec49d8a603ce3c2499564991c3db4bec7
    f1ee3d2caa60e2174fdc69c3c5c8d3d1aefc1b80
    577ddc3ee7b8459f85daf90d6af4649651ab7449

MAGIC used the following procedure selection criteria:

   - Select clones,
   - with between 5 and 50 blocks, and
   - between 10 and 100 instructions, and
   - between 50 and 100 bytes
   - and a coverage of 80-100%

MAGIC selected 54 shared functions that matched this criteria. Published in this report are two version of rules generated by MAGIC. The two versions differ in the condition sections where it gives the number of selected procedures that should be present in the binary to be considered matched.

   - Version v1: Requires any 5 of the selected procedures to be present
   - Version v2: Require that ANY one of the selected procedures to be present

Clearly rule v1 is more strict than v2.

##CONTENTS##

* yara/ - contains yara rules
   - CythMAGIC_wannacry5_v1.yar: A bit stringent rule. 
   - CythMAGIC_wannacry5_v2.yar: Most relaxed rule.
   


