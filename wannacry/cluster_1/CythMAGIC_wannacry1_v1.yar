rule CythMAGIC_wannacry1_v1
{
 meta:

	author = "Cythereal, Inc"
	description = ""
	cluster_id = "ff5e2689369dcf278566d7b6e68a779131c9a6fd"
	size_of_cluster = "97"
	criteria = "clones with 5 <= 50 <= block_counts 10 <= 100 <= instr_counts 50 <= 100 <= byte_counts 0.8 <= 1 <= coverage"
 strings:

	$_d413ef08f5c73917bc7cbe9cb64f6534 = { A1 6C 14 43 00 56 8B 30 3B F0 74 49 8B 46 10 50 E8 8B 84 00 00 8B 46 08 8B 0D 78 F8 70 00 3B C1 74 12 8B F0 8B 06 3B C1 74 23 8B F0 8B 06 3B C1 75 F8 EB 19 8B 46 04 3B 70 08 75 0A 8B F0 8B 40 04 3B 70 08 74 F6 39 46 08 74 02 8B F0 3B 35 6C 14 43 00 75 B7 5E C3 }
	$_9c6d1caaa16dc8c1ec5e1e70e997d1b9 = { 81 EC 90 01 00 00 8D 44 24 00 50 68 02 02 00 00 E8 47 1C 00 00 85 C0 74 09 33 C0 81 C4 90 01 00 00 C3 E8 69 FA FF FF E8 64 FE FF FF 81 C4 90 01 00 00 C3 }
	$_98f4fe4761466737c1f0db002317455f = { 51 A1 70 F8 70 00 85 C0 75 08 FF 15 18 A1 40 00 59 C3 68 18 14 43 00 FF 15 80 A0 40 00 8B 0D 70 F8 70 00 8D 44 24 00 50 6A 04 51 FF 15 20 A0 40 00 68 18 14 43 00 FF 15 84 A0 40 00 8B 44 24 00 59 C3 }
	$_f9cbd34ead462e5d1e03bc3d07f14f29 = { 53 55 56 57 8B 7C 24 18 83 C9 FF 33 C0 8B 74 24 1C F2 AE 8B 44 24 14 F7 D1 49 0F BE D1 8B C8 2B CA 8D 1C 31 3B C3 77 13 8B 7C 24 18 8B CA 8B F0 33 ED F3 A6 74 07 40 3B C3 76 ED 33 C0 5F 5E 5D 5B C3 }
	$_7a6ec7369c56146e83f177a6fa70ea41 = { 8B 44 24 04 48 83 F8 04 77 3A FF 24 85 ?? ?? ?? ?? 33 C0 C7 05 ?? ?? ?? ?? ?? ?? ?? ?? A3 ?? ?? ?? ?? A3 ?? ?? ?? ?? A3 ?? ?? ?? ?? EB 16 C7 05 ?? ?? ?? ?? ?? ?? ?? ?? EB 0A C7 05 ?? ?? ?? ?? ?? ?? ?? ?? 8B 0D ?? ?? ?? ?? 68 ?? ?? ?? ?? 51 FF 15 ?? ?? ?? ?? C2 04 00 }
	$_737e087f5f80cd0e74d60b9fcc1d7c42 = { 83 EC 08 8B 4C 24 0C 56 8B 74 24 18 33 C0 89 44 24 05 3B F0 89 4C 24 04 7E 2D 8B 4C 24 14 53 8B D0 81 E2 03 00 00 80 79 05 4A 83 CA FC 42 8A 54 14 08 8A 1C 08 32 DA 88 1C 08 40 3B C6 7C E0 5B 33 C0 5E 83 C4 08 C3 33 C0 5E 83 C4 08 C3 }
	$_03faf3705506a9765be6172499cd5b3c = { 53 8B 5C 24 08 55 8B 6C 24 10 3B DD 57 74 4B 8D 7B 04 3B FD 74 44 56 8B 37 8B 03 3B F0 ?? ?? 8B 4F FC 8D 47 FC 3B F1 8B D7 ?? ?? 89 0A 8B 48 FC 8B D0 83 E8 04 3B F1 ?? ?? 89 32 EB 15 3B DF 8B C7 74 0D 8B 48 FC 83 E8 04 3B C3 89 48 04 75 F3 89 33 83 C7 04 3B FD 75 BE 5E 5F 5D 5B C3 }
	$_e870bedef7fd6e90e125098b6b6795cb = { 56 8B 74 24 08 57 56 E8 1C 07 00 00 8B F8 8B 44 24 10 50 E8 10 07 00 00 3B C7 77 1E 56 E8 06 07 00 00 8B 4C 24 14 8B F0 51 E8 FA 06 00 00 3B F0 77 08 5F B8 01 00 00 00 5E C3 5F 33 C0 5E C3 }
	$_6104c57ed4e41ae9955a3fc41da6cae4 = { 56 57 8B 3D 24 A0 40 00 33 F6 8B C6 68 00 00 00 F0 F7 D8 1B C0 6A 01 25 C4 12 43 00 50 6A 00 68 70 F8 70 00 FF D7 85 C0 75 06 46 83 FE 02 7C DA 68 18 14 43 00 FF 15 88 A0 40 00 5F 5E C3 }
 condition:

	all of them // out of 9
}
