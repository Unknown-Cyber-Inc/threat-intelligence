**WannaCry (cluster 3) - YARA rules generated by malware genomic analysis**

This folder contains Yara rules automatically generated by MAGIC for WannaCry. 

The rules were generated using a cluster of the following 8 samples.

    f119df0da40d0817a6f14a1e2ac21727a7186930
    0b912fea4b8029dfa499fdca9b166fcf36f695c2
    4a94dd55124a2e14e6613a31950ad0fa4f0ab9aa
    233cd41173d593bbfe2ffafb507cb23011aeb4ce
    2098d767e8f2e943feb21dd9074f32cc0d404b10
    37cb5eadaae6c8c01f2fd7320cc801540ab56d0f
    2804c040a4de92d87e143fbc8a07301ae1ae28a8
    825b6f2d9b2614cd5c084dde8e2b95631aea8be3


MAGIC used the following procedure selection criteria:

   - Select clones,
   - with between 5 and 50 blocks, and
   - between 10 and 100 instructions, and
   - between 50 and 100 bytes
   - and a coverage of 80-100%

MAGIC selected 31 shared functions that matched this criteria. Published in this report are two version of rules generated by MAGIC. The two versions differ in the condition sections where it gives the number of selected procedures that should be present in the binary to be considered matched.

   - Version v1: Requires any 5 of the selected procedures to be present
   - Version v2: Require that ANY one of the selected procedures to be present

Clearly rule v1 is more strict than v2.

##CONTENTS##

* yara/ - contains yara rules
   - CythMAGIC_wannacry3_v1.yar: A bit stringent rule. 
   - CythMAGIC_wannacry3_v2.yar: Most relaxed rule.
   


